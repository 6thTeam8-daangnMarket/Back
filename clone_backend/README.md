# Clone Project

## Clone Coding Project "ë‹¹ê·¼ë§ˆì¼“" Backend

ë‹¹ê·¼ë§ˆì¼“ í´ë¡ ì½”ë”©
<br>


## ì§„í–‰ê¸°ê°„

- 2022.04.16(ê¸ˆ) ~ 2022.04.22(ëª©)
  <br>

## âš™ ì£¼ìš” ê¸°ëŠ¥

#### APIì„¤ê³„ [ë…¸ì…˜](https://www.notion.so/8-00adac21af6d49699787e1bd1b5774c7)

#### WIREFRAME [PIGMA](https://www.figma.com/file/B6WEXes2RDdsOecbfTQKqP/%EB%AF%B8%EB%8B%88%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8?node-id=0%3A1)

### 1. íšŒì›ê°€ì… / ë¡œê·¸ì¸
    - íšŒì› ê°€ì… ì‹œ ì•„ì´ë””/ë‹‰ë„¤ì„ ì¤‘ë³µê²€ì‚¬
    - JWT ì¸ì¦ë°©ì‹ì„ í†µí•œ ë¡œê·¸ì¸ êµ¬í˜„
    - ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ Handlerë¥¼ í†µí•´ ì—ëŸ¬ë©”ì„¸ì§€ ì „ë‹¬

### 2. ë©”ì¸ í˜ì´ì§€
    - ìƒí’ˆ ëª©ë¡ ì¡°íšŒ
    - ì‚¬ìš©ìê°€ ìƒí’ˆ ê´€ì‹¬ ë“±ë¡ ì—¬ë¶€ í™•ì¸
    - ì œëª©ì— ë”°ë¥¸ í‚¤ì›Œë“œë³„ ê²€ìƒ‰
    - ì¹´í…Œê³ ë¦¬ë³„ ìƒí’ˆ ì¡°íšŒ
    - S3ë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ìˆ˜ì • ê°€ëŠ¥

### 3. ìƒì„¸ í˜ì´ì§€
    - ìƒí’ˆì— ëŒ€í•œ ì •ë³´ ì¡°íˆ
    - ê´€ì‹¬ ìƒí’ˆ ë“±ë¡ ë° ì‚­ì œ ê°€ëŠ¥
    - ê²Œì‹œê¸€ ìˆ˜ì • ë° ì‚­ì œ (ì‘ì„±ì ë³¸ì¸ì— í•œí•¨)

### 4. ë§ˆì´ í˜ì´ì§€
    - íšŒì›ê°€ì… ì‹œ ë“±ë¡í–ˆë˜ ê°œì¸ ì •ë³´ ì—´ëŒ
    - ê´€ì‹¬ ìƒí’ˆ ëª©ë¡ ì¡°íˆ
    
<br>

## ğŸ”¨ ê°œë°œ íˆ´

<a href="" target="_blank"><img src="https://img.shields.io/badge/React-61DAFB?style=flat-square&logo=React&logoColor=white"/></a>
<a href="" target="_blank"><img src="https://img.shields.io/badge/Redux-764ABC?style=flat-square&logo=Redux&logoColor=white"/></a>
<img src="https://img.shields.io/badge/gradle-02303A?style=for-the-badge&logo=gradle&logoColor=white">
<img src="https://img.shields.io/badge/Springboot-6DB33F?style=for-the-badge&logo=Springboot&logoColor=white">
<img src= "https://img.shields.io/badge/IntelliJIDEA-000000.svg?style=for-the-badge&logo=intellij-idea&logoColor=white" width="110" height="30"/>

<br>


## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ íŒ€ì›

|  ì´ë¦„  |                          ê¹ƒí—ˆë¸Œ ì£¼ì†Œ                           |       í¬ì§€ì…˜       |
| :----: | :------------------------------------------------------------: | :----------------: |
| ì˜¤ì˜ˆë ¹ |      [https://github.com/ohyeryung](https://github.com/ohyeryung)      |    ë°±ì—”ë“œ(ìŠ¤í”„ë§)   |
| ì´ìŠ¹ì¬ | [https://github.com/langho968](https://github.com/langho968)   |    ë°±ì—”ë“œ(ìŠ¤í”„ë§)   |
| ê¹€ë¯¼ì„± |   [https://github.com/lincoln-burrows](https://github.com/lincoln-burrows)   |    ë°±ì—”ë“œ(ìŠ¤í”„ë§)   |
| ì´ì¶˜ |  [https://github.com/lee-chun-91](https://github.com/lee-chun-91) |  í”„ë¡ íŠ¸ì—”ë“œ(ë¦¬ì•¡íŠ¸) | 
| ë…¸í˜„ì • |  [https://github.com/isabel-noh](https://github.com/isabel-noh)  |  í”„ë¡ íŠ¸ì—”ë“œ(ë¦¬ì•¡íŠ¸) |


**BacK End** : https://github.com/6thTeam8-daangnMarket/Back/tree/main/clone_backend

**Front End** : https://github.com/6thTeam8-daangnMarket/Front


<br>





<br>

<h3 align="center"><b>ğŸ“‚ Project Directory Structure ğŸ“</b></h3>

<pre>
<code>
/com.sparta.clone_backend
  â””â”€â”€/config
     â””â”€â”€ /AmazonS3.java
  â””â”€â”€/controller
     â”œâ”€â”€ /PostController.java
     â”œâ”€â”€ /PostLikeController.java
     â””â”€â”€ /UserController.java
  â””â”€â”€/dto
     â”œâ”€â”€ /DuplicateChkDto.java
     â”œâ”€â”€ /IsLoginDto.java
     â”œâ”€â”€ /CommentRequestDto.java
     â”œâ”€â”€ /CommentResponseDto.java
     â”œâ”€â”€ /FrontRequestDto.java
     â”œâ”€â”€ /FrontResponseDto.java
     â”œâ”€â”€ /PostRequestDto.java
     â”œâ”€â”€ /PostResponseDto.java
     â”œâ”€â”€ /ResponseDto.java
     â””â”€â”€ /SignupRequestDto.java
  â””â”€â”€/model
     â”œâ”€â”€ /Back.java
     â”œâ”€â”€ /Comment.java
     â”œâ”€â”€ /Front.java
     â”œâ”€â”€ /Post.java
     â”œâ”€â”€ /Timestamped.java
     â””â”€â”€ /User.java
  â””â”€â”€/repository
     â”œâ”€â”€ /BackRepository.java
     â”œâ”€â”€ /CommentRepository.java
     â”œâ”€â”€ /FrontRepository.java
     â”œâ”€â”€ /PostRepository.java
     â””â”€â”€ /UserRepository.java
  â””â”€â”€/security
     â””â”€â”€ /filter
         â”œâ”€â”€ /FormLoginFilter.java
         â””â”€â”€ /JwtAuthFilter.java
     â””â”€â”€ /jwt
         â”œâ”€â”€ /HeaderTokenExtractor.java
         â”œâ”€â”€ /JwtDecoder.java
         â”œâ”€â”€ /JwtPreProcessingToken.java
         â””â”€â”€ /JwtTokenUtils.java
     â””â”€â”€ /provider
         â”œâ”€â”€ /AuthFailureHandler.java
         â”œâ”€â”€ /FilterSkipMatcher.java
         â”œâ”€â”€ /FormLoginSuccessHandler.java
         â”œâ”€â”€ /UserDetailsImpl.java
         â”œâ”€â”€ /UserDetailsServiceImpl.java
         â””â”€â”€ /WebSecurityConfig.java
  â””â”€â”€/service
     â”œâ”€â”€ /BackService.java
     â”œâ”€â”€ /CommentService.java
     â”œâ”€â”€ /FrontService.java
     â”œâ”€â”€ /PostService.java
     â””â”€â”€ /UserService.java
  â””â”€â”€/validator
     â””â”€â”€ /UserInfoValidator.java
  â””â”€â”€/Mini22Application.java
</code>
</pre>


## ğŸ§¾Trouble Shooting

 <p> </p>
 <p> </p>
 <p> </p>


<details>
<summary>MultipartFileê³¼ JSONìœ¼ë¡œ ë³´ë‚¼ë•Œ í”„ë¡ íŠ¸ì¸¡ì— ì œëŒ€ë¡œ ë°ì´í„°ê°€ ì•ˆê°€ëŠ” ë¬¸ì œ</summary>
<div markdown="1">

```java
@PostMapping("/post")
    public ResponseEntity<String> writePost(@RequestPart("file") MultipartFile multipartFile, @RequestPart("post") PostsRequestDto requestDto,
                                            @AuthenticationPrincipal UserDetailsImpl userDetails) throws IOException {
        System.out.println(requestDto.getContent());

        // String image = s3Uploader.upload(multipartFile, "postImage");
        String image = s3Uploader.upload(multipartFile,"postImage");
        requestDto.setImage(image);
        postService.writePost(requestDto, userDetails.getUser());
        return ResponseEntity.ok()
                .body("ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤ true");
    }
```
@RequestPartë¡œ ë‘˜ë‹¤ multipart/form-data í˜•íƒœë¡œ ì „ì†¡í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°

</div>
</details>







<details>
<summary>ê²Œì‹œë¬¼ ì‚­ì œì‹œ Likesì™€ì˜ ì—°ê´€ ê´€ê³„ë¡œ ì¸í•´ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ë©´ ì‚­ì œ ì•ˆë˜ëŠ” ë¬¸ì œ</summary>
<div markdown="1">


```java
 @JsonIgnore
    @OneToMany(cascade = CascadeType.REMOVE, mappedBy = "post")
    private List<Likes> LikesList  = new ArrayList<>();
```
cascade = CascadeType.REMOVE ë¥¼ ì´ìš©í•˜ì—¬ í•´ê²°

</div>
</details>




<details>
<summary>ê±°ë˜ë¥¼ í•œ ìƒëŒ€ì—ê²Œ ë¬´í•œì •ìœ¼ë¡œ í›„ê¸°ë¥¼ ë‚¨ê¸¸ìˆ˜ ìˆëŠ” ë¬¸ì œ</summary>
<div markdown="1">

```java
public RatedDto addRate(RateDto rateDto){ //ìœ ì € í‰ê°€í•˜ê¸°

        RatedDto ratedDto = new RatedDto();
        Post post = postRepository.findById(rateDto.getPostId()).get();
        post.setRated(true);


        int rate1 = rateDto.getRate();
        User user = userRepository.findById(rateDto.getId()).get();  //í‰ê°€ ì ìˆ˜ ë”í•˜ëŠ” ë¡œì§
        int currentRate = user.getRate();
        user.setRate(currentRate + rate1);
        User user2 = userRepository.save(user);


        rateDto.setRate(user2.getRate());
        ratedDto.setRated(true);
        return ratedDto;
    }
```
í”„ë¡ íŠ¸ì¸¡ì— ìœ ì €ì˜ ì•„ì´ë””ë§Œ ë°›ê³  í‰ì ì„ ë‚¨ê¸°ëŠ” ì‹ìœ¼ë¡œ í•˜ì˜€ëŠ”ë° ì´ë²ˆì— postì•„ì´ë””ë„ í•¨ê»˜ ë°›ì•„ì„œ í¬ìŠ¤íŠ¸ì— boolean rated = false;//í‰ê°€ì—¬ë¶€ í•­ëª©ì„ ì¶”ê°€í•˜ì—¬ post ì•„ì´ë””ë¥¼ ë°›ì•„ì„œ
í•´ë‹¹ ê²Œì‹œë¬¼ì„ ì°¾ê³  trueë¡œ ë°”ê¿”ì„œ ê±°ë˜ë¥¼ í•œ ê²Œì‹œë¬¼ì„ ì•Œë ¤ì£¼ì—ˆìŠµë‹ˆë‹¤.

</div>
</details>






<details>
<summary>S3 ë²„í‚· ê´€ë ¨ ACL ê´€ë ¨ ì—ëŸ¬ </summary>
<div markdown="1">


 <img src="https://user-images.githubusercontent.com/97422693/155449111-a04a7db8-f8ab-4841-bf4e-edc89047e996.PNG" width="600" />


AWSì— ë“¤ì–´ê°€ì„œ ê°ì²´ ì†Œìœ ê¶Œì— ëŒ€í•œ  ACL í™œì„±í™”ë¥¼ í•´ì£¼ì—ˆë‹¤


</div>
</details>
